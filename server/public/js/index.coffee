shapes = [
    "M 100,50 L 98.984178,60.076744 L 96.070752,69.462256 L 91.460785,77.955475 L 85.355339,85.355339 L 77.955476,91.460785 L 69.462256,96.070752 L 60.076744,98.984178 L 50,100 L 39.923256,98.984178 L 30.537744,96.070752 L 22.044525,91.460785 L 14.644661,85.355339 L 8.5392148,77.955476 L 3.9292479,69.462256 L 1.0158224,60.076744 L 0,50 L 1.0158223,39.923256 L 3.9292479,30.537744 L 8.539215,22.044525 L 14.644661,14.644661 L 22.044525,8.5392148 L 30.537744,3.9292479 L 39.923256,1.0158224 L 50,0 L 60.076744,1.0158223 L 69.462256,3.9292479 L 77.955475,8.539215 L 85.355339,14.644661 L 91.460785,22.044524 L 96.070752,30.537744 L 98.984178,39.923256 Z"
    "M 48.841797,0.24804688 L 45.699219,7.8413087 L 42.55664,15.43457 L 39.414062,23.027832 L 36.271484,30.621094 L 27.858886,31.939453 L 19.446289,33.257812 L 11.033691,34.576172 L 2.6210938,35.894531 L 8.8715821,41.22998 L 15.12207,46.565429 L 21.372559,51.900879 L 27.623047,57.236328 L 26.277344,65.644043 L 24.93164,74.051758 L 23.585937,82.459473 L 22.240234,90.867188 L 29.246093,86.57129 L 36.251953,82.275391 L 43.257812,77.979492 L 50.263672,73.683594 L 57.844238,77.562012 L 65.424805,81.44043 L 73.005371,85.318848 L 80.585938,89.197266 L 78.66504,81.207031 L 76.744141,73.216797 L 74.823242,65.226562 L 72.902344,57.236328 L 78.933106,51.225098 L 84.963867,45.213867 L 90.994629,39.202636 L 97.025391,33.191406 L 88.833008,32.548828 L 80.640625,31.90625 L 72.448242,31.263672 L 64.255859,30.621094 L 60.402343,23.027832 L 56.548828,15.43457 L 52.695312,7.8413087 Z"
    "M 2.9042969,1.9472656 L 2.9042969,25.95166 L 2.9042969,49.956055 L 2.9042969,73.960449 L 2.9042969,97.964844 L 26.437012,97.964844 L 49.969726,97.964844 L 73.502441,97.964844 L 97.035156,97.964844 L 97.035156,73.960449 L 97.035156,49.956055 L 97.035156,25.95166 L 97.035156,1.9472656 L 73.502441,1.9472656 L 49.969726,1.9472656 L 26.437012,1.9472656 Z"
    "M 48.912109,0.43554688 L 38.011718,19.316406 L 27.111328,38.197265 L 16.210937,57.078125 L 5.3105469,75.958984 L 27.111816,75.958984 L 48.913086,75.958984 L 70.714355,75.958984 L 92.515625,75.958984 L 81.614746,57.078125 L 70.713867,38.197265 L 59.812988,19.316406 Z"
    "M 30.082506,13.045993 L 24.759299,13.581983 L 19.801166,15.120505 L 15.314339,17.555341 L 11.405054,20.780272 L 8.1795445,24.68908 L 5.744045,29.175546 L 4.2047896,34.133452 L 3.6680129,39.456579 L 4.3872259,44.812479 L 6.3707538,49.956345 L 9.355382,54.915138 L 13.077895,59.715817 L 17.275079,64.385342 L 21.683719,68.950673 L 26.040599,73.438771 L 30.082506,77.876595 L 32.655292,80.679063 L 35.727119,83.745531 L 39.038443,86.87946 L 42.329719,89.88431 L 45.341401,92.563541 L 47.813944,94.720613 L 49.487803,96.158986 L 50.103433,96.682118 L 50.718301,96.158888 L 52.390099,94.720279 L 54.859622,92.562915 L 57.867665,89.88342 L 61.155021,86.878417 L 64.462486,83.74453 L 67.530852,80.678382 L 70.100913,77.876595 L 74.141407,73.437919 L 78.49726,68.949299 L 82.905197,64.383732 L 87.101944,59.714214 L 90.824223,54.913742 L 93.808759,49.955315 L 95.792276,44.811928 L 96.511499,39.456579 L 95.974828,34.133979 L 94.435863,29.176493 L 92.000801,24.690319 L 88.775839,20.781653 L 84.867173,17.556691 L 80.380999,15.121629 L 75.423514,13.582664 L 70.100913,13.045993 L 67.236028,13.203288 L 64.429656,13.665071 L 61.704224,14.421084 L 59.082157,15.460995 L 56.585883,16.774491 L 54.237827,18.351259 L 52.060416,20.180983 L 50.076076,22.253352 L 48.094676,20.183734 L 45.920678,18.356036 L 43.576411,16.780541 L 41.084202,15.467532 L 38.466379,14.42729 L 35.745271,13.670098 L 32.943203,13.206238 Z"
    "M 58.64136,48.825863 L 58.500365,50.224505 L 58.095984,51.527204 L 57.456125,52.706054 L 56.608696,53.733147 L 55.581603,54.580577 L 54.402753,55.220435 L 53.100053,55.624816 L 51.701412,55.765811 L 50.30277,55.624816 L 49.000071,55.220436 L 47.821221,54.580577 L 46.794128,53.733147 L 45.946698,52.706054 L 45.30684,51.527204 L 44.902459,50.224504 L 44.761464,48.825863 L 44.902459,47.427221 L 45.306839,46.124522 L 45.946698,44.945672 L 46.794128,43.918579 L 47.821221,43.071149 L 49.000071,42.431291 L 50.302771,42.02691 L 51.701412,41.885915 L 53.100054,42.02691 L 54.402753,42.43129 L 55.581603,43.071149 L 56.608696,43.918579 L 57.456125,44.945672 L 58.095985,46.124522 L 58.500365,47.427221 Z M 67.794071,48.569645 L 67.463655,51.726815 L 66.516007,54.667413 L 65.016526,57.328445 L 63.030611,59.646915 L 60.623662,61.559827 L 57.861078,63.004188 L 54.808259,63.917001 L 51.530602,64.235271 L 48.252945,63.917001 L 45.200126,63.004189 L 42.437541,61.559829 L 40.030592,59.646916 L 38.044677,57.328446 L 36.545196,54.667414 L 35.597548,51.726815 L 35.267132,48.569645 L 35.597548,45.412475 L 36.545196,42.471876 L 38.044677,39.810845 L 40.030592,37.492375 L 42.437542,35.579462 L 45.200126,34.135102 L 48.252946,33.222289 L 51.530602,32.904019 L 54.808259,33.222289 L 57.861078,34.135102 L 60.623662,35.579462 L 63.030611,37.492375 L 65.016526,39.810845 L 66.516007,42.471877 L 67.463655,45.412475 Z M 95.770944,49.167485 L 94.870402,49.842727 L 92.287607,51.62291 L 88.200801,54.139721 L 82.788232,57.024845 L 76.228142,59.90997 L 68.698775,62.42678 L 60.378378,64.206963 L 51.445193,64.882205 L 42.512009,64.206963 L 34.191611,62.42678 L 26.662245,59.909969 L 20.102155,57.024845 L 14.689585,54.13972 L 10.60278,51.62291 L 8.0199848,49.842727 L 7.1194431,49.167485 L 8.0199847,48.433526 L 10.60278,46.498545 L 14.689585,43.762881 L 20.102154,40.626876 L 26.662244,37.490871 L 34.19161,34.755208 L 42.512008,32.820226 L 51.445193,32.086268 L 60.378378,32.820226 L 68.698776,34.755208 L 76.228142,37.490872 L 82.788232,40.626876 L 88.200802,43.762881 L 92.287607,46.498545 L 94.870402,48.433526 Z"
    "M 47.074464,83.285702 L 44.797853,82.397485 L 42.821395,80.996943 L 41.107067,79.049637 L 39.616843,76.521126 L 38.6297,74.270015 L 36.474276,69.224291 L 33.468397,62.131515 L 29.929962,53.739216 L 27.688291,48.410151 L 25.446621,43.081086 L 23.20495,37.752022 L 20.963279,32.422957 L 20.951691,38.702558 L 20.940103,44.982159 L 20.928514,51.26176 L 20.916926,57.541361 L 20.905294,63.820919 L 20.893663,70.100476 L 20.882031,76.380034 L 20.8704,82.659592 L 19.220334,82.659592 L 17.570267,82.659592 L 15.920201,82.659592 L 14.270135,82.659592 L 12.620025,82.659592 L 10.969915,82.659592 L 9.3198058,82.659592 L 7.669696,82.659592 L 7.6826246,75.708091 L 7.6955532,68.75659 L 7.7084818,61.805089 L 7.7214104,54.853588 L 7.7342957,47.902087 L 7.7471811,40.950585 L 7.7600664,33.999084 L 7.7729518,27.047582 L 7.8753433,26.686705 L 7.9777347,26.325827 L 8.0801262,25.96495 L 8.1825177,25.604072 L 9.0919005,23.130494 L 10.293605,21.104883 L 11.7971,19.514577 L 13.611855,18.34691 L 16.158309,17.439011 L 18.883712,17.071186 L 21.669046,17.247565 L 24.395293,17.972281 L 26.348753,19.012478 L 28.231791,20.599715 L 29.958162,22.647097 L 31.441618,25.067728 L 32.493241,27.432164 L 34.669865,32.541887 L 37.653698,39.644773 L 41.126943,47.988695 L 44.537929,56.179492 L 47.352246,62.865453 L 49.277992,67.358129 L 50.023267,68.969069 L 50.770487,67.243301 L 52.701552,62.650682 L 55.523743,55.890397 L 58.944341,47.661631 L 62.393823,39.364629 L 65.294591,32.418712 L 67.341941,27.551369 L 68.23117,25.490092 L 70.708809,21.653469 L 73.706783,18.977602 L 77.221102,17.465054 L 81.247778,17.118386 L 84.7409,17.699655 L 87.545594,19.0285 L 89.685612,21.121364 L 91.184709,23.994694 L 91.809289,25.910662 L 92.119103,29.432419 L 92.236088,38.019307 L 92.282177,55.130666 L 92.297848,62.014021 L 92.31352,68.897377 L 92.329191,75.780732 L 92.344862,82.664088 L 90.682878,82.652068 L 89.020893,82.640048 L 87.358908,82.628027 L 85.696924,82.616007 L 84.034932,82.603986 L 82.37294,82.591965 L 80.710949,82.579945 L 79.048957,82.567924 L 79.026053,76.328233 L 79.003149,70.088543 L 78.980245,63.848852 L 78.957341,57.609161 L 78.934437,51.369427 L 78.911533,45.129693 L 78.888629,38.889958 L 78.865725,32.650224 L 76.693445,37.813422 L 74.521165,42.97662 L 72.348886,48.139817 L 70.176606,53.303015 L 66.73503,61.468072 L 63.787676,68.432423 L 61.647827,73.45767 L 60.628783,75.805423 L 59.047283,78.662764 L 57.257324,80.824568 L 55.200861,82.346438 L 52.819849,83.283972 L 51.523259,83.488744 L 49.936487,83.557377 L 48.355049,83.48974 Z"
    "M 22.883142,93.528008 L 19.599615,92.468621 L 16.886555,90.524205 L 14.836183,87.785438 L 13.540717,84.342997 L 13.17024,72.861576 L 13.046003,50.131822 L 13.168443,27.445155 L 13.538003,16.092997 L 14.752145,12.819023 L 16.538169,10.244756 L 18.905823,8.3597412 L 21.864853,7.1535248 L 23.946379,6.9629231 L 29.32004,6.8449402 L 39.283712,6.784391 L 55.135272,6.7660905 L 63.093585,6.7652763 L 71.051897,6.7644622 L 79.01021,6.7636481 L 86.968523,6.7628339 L 86.968523,9.0622747 L 86.968523,11.361715 L 86.968523,13.661156 L 86.968523,15.960597 L 86.968523,18.260105 L 86.968523,20.559614 L 86.968523,22.859122 L 86.968523,25.15863 L 80.362683,25.15863 L 73.756842,25.15863 L 67.151002,25.15863 L 60.545161,25.15863 L 46.430498,25.172361 L 38.394943,25.232868 L 34.715744,25.369123 L 33.670146,25.610095 L 33.43674,26.096952 L 33.299567,27.241598 L 33.234763,29.438818 L 33.218465,33.083396 L 33.218465,34.838787 L 33.218465,36.594179 L 33.218465,38.34957 L 33.218465,40.104962 L 39.793504,40.104962 L 46.368544,40.104962 L 52.943584,40.104962 L 59.518623,40.104962 L 66.093663,40.104962 L 72.668702,40.104962 L 79.243742,40.104962 L 85.818782,40.104962 L 85.818782,42.332572 L 85.818782,44.560183 L 85.818782,46.787793 L 85.818782,49.015404 L 85.818782,51.243015 L 85.818782,53.470625 L 85.818782,55.698236 L 85.818782,57.925847 L 79.243742,57.925847 L 72.668702,57.925847 L 66.093663,57.925847 L 59.518623,57.925847 L 52.943584,57.925847 L 46.368544,57.925847 L 39.793504,57.925847 L 33.218465,57.925847 L 33.218465,59.998606 L 33.218465,62.071366 L 33.218465,64.144125 L 33.218465,66.216885 L 33.232241,70.759468 L 33.299004,73.310551 L 33.456907,74.50653 L 33.744105,74.983803 L 34.755103,75.241711 L 38.318884,75.384802 L 46.31403,75.446297 L 60.61912,75.459413 L 67.206471,75.459413 L 73.793822,75.459413 L 80.381172,75.459413 L 86.968523,75.459413 L 86.968523,77.758853 L 86.968523,80.058294 L 86.968523,82.357734 L 86.968523,84.657175 L 86.968523,86.956684 L 86.968523,89.256192 L 86.968523,91.555701 L 86.968523,93.85521 L 79.153925,93.8468 L 71.339326,93.838389 L 63.524727,93.829978 L 55.710129,93.821568 L 43.449318,93.788012 L 33.173121,93.721487 L 25.958681,93.631602 Z"
    "M 12.487073,56.076369 L 12.506729,32.122902 L 12.669341,19.877078 L 13.140935,14.805854 L 14.087529,12.376187 L 14.941992,10.961822 L 16.108246,9.5589584 L 17.42588,8.3371401 L 18.734484,7.465911 L 20.764087,6.6504044 L 25.1049,6.238423 L 35.374538,6.0915047 L 55.190618,6.0714428 L 63.275909,6.0706157 L 71.361201,6.0697885 L 79.446493,6.0689613 L 87.531784,6.0681342 L 87.531784,8.4042639 L 87.531784,10.740394 L 87.531784,13.076523 L 87.531784,15.412653 L 87.531784,17.748851 L 87.531784,20.085049 L 87.531784,22.421247 L 87.531784,24.757445 L 80.820551,24.757445 L 74.109318,24.757445 L 67.398084,24.757445 L 60.686851,24.757445 L 46.346965,24.771395 L 38.183192,24.832868 L 34.445286,24.971296 L 33.383004,25.216113 L 33.137501,26.494788 L 32.99907,31.224888 L 32.937883,41.674719 L 32.924116,60.112585 L 32.924116,68.721967 L 32.924116,77.33135 L 32.924116,85.940732 L 32.924116,94.550114 L 30.368948,94.550114 L 27.81378,94.550114 L 25.258613,94.550114 L 22.703445,94.550114 L 20.14827,94.550114 L 17.593095,94.550114 L 15.03792,94.550114 L 12.482745,94.550114 L 12.483827,84.931678 L 12.484909,75.313242 L 12.485991,65.694805 Z"
    "M 62.521149,57.746148 L 60.827918,53.483201 L 57.067962,44.177493 L 53.22089,34.713521 L 51.266308,29.975779 L 51.066537,29.627638 L 50.812742,29.301506 L 50.537509,29.0339 L 50.273422,28.861337 L 49.942883,28.743243 L 49.674858,28.748676 L 49.408443,28.894883 L 49.082738,29.199111 L 48.442441,30.434447 L 47.128602,33.419154 L 45.247634,37.904441 L 42.905953,43.641516 L 40.727874,49.026765 L 38.927207,53.465125 L 37.690964,56.496594 L 37.206158,57.661171 L 38.165379,57.73438 L 40.8609,57.794304 L 44.879258,57.834778 L 49.806994,57.84964 L 54.743661,57.84148 L 58.786366,57.819257 L 61.517923,57.786352 Z M 5.2554579,88.843702 L 9.9668139,78.04958 L 20.198502,54.846522 L 30.544509,31.471224 L 35.598823,20.160382 L 38.160448,16.314001 L 41.399879,13.551707 L 45.297685,11.885519 L 49.834435,11.327452 L 51.989973,11.438644 L 54.034841,11.764268 L 55.914226,12.292397 L 57.573312,13.011103 L 59.262302,14.187649 L 61.069354,15.895982 L 62.721266,17.847008 L 63.944834,19.751635 L 68.710029,30.378027 L 78.613059,52.698047 L 88.788825,75.724295 L 94.372227,88.469373 L 94.458866,88.674459 L 94.545505,88.879545 L 94.632145,89.084631 L 94.718784,89.289717 L 92.290773,89.27322 L 89.862762,89.256722 L 87.43475,89.240225 L 85.006739,89.223728 L 82.578734,89.20729 L 80.150728,89.190853 L 77.722723,89.174415 L 75.294718,89.157977 L 74.494266,87.177617 L 73.693815,85.197258 L 72.893363,83.216898 L 72.092911,81.236538 L 71.292465,79.256238 L 70.492019,77.275938 L 69.691574,75.295639 L 68.891128,73.315339 L 64.146193,73.299198 L 59.401258,73.283056 L 54.656324,73.266915 L 49.911389,73.250774 L 45.166448,73.234692 L 40.421508,73.218611 L 35.676567,73.202529 L 30.931626,73.186447 L 30.278823,74.805652 L 29.626021,76.424857 L 28.973218,78.044061 L 28.320415,79.663266 L 27.251639,82.302225 L 26.27196,84.699409 L 25.489857,86.590685 L 25.013834,87.711932 L 24.839992,88.104894 L 24.666149,88.497857 L 24.492307,88.89082 L 24.318465,89.283782 L 21.919519,89.283782 L 19.520573,89.283782 L 17.121628,89.283782 L 14.722682,89.283782 L 9.421052,89.2732 L 6.5611907,89.218891 L 5.415269,89.087007 Z"
    "M 69.89505,64.251518 L 73.257796,63.136089 L 75.942509,61.378453 L 77.963134,58.966232 L 79.333615,55.887043 L 79.808233,54.019107 L 80.12349,51.941596 L 80.299515,49.46806 L 80.356439,46.41205 L 80.153826,41.161111 L 79.473808,37.165164 L 78.229624,34.106058 L 76.33451,31.665643 L 75.189508,30.665297 L 73.938498,29.8527 L 72.52689,29.197737 L 70.900096,28.670294 L 69.136981,28.276463 L 67.168133,28.022728 L 64.74242,27.886818 L 61.608708,27.846464 L 60.514406,27.846464 L 59.420103,27.846464 L 58.325801,27.846464 L 57.231499,27.846464 L 57.231499,32.476287 L 57.231499,37.10611 L 57.231499,41.735932 L 57.231499,46.365755 L 57.231499,50.995625 L 57.231499,55.625494 L 57.231499,60.255364 L 57.231499,64.885233 L 58.575744,64.857437 L 59.919989,64.82964 L 61.264235,64.801844 L 62.60848,64.774048 L 65.366841,64.701236 L 67.304953,64.603932 L 68.71647,64.461054 Z M 42.758862,46.315854 L 42.758862,41.686838 L 42.758862,37.057822 L 42.758862,32.428805 L 42.758862,27.799789 L 41.414612,27.825451 L 40.070362,27.851112 L 38.726112,27.876773 L 37.381862,27.902435 L 33.439558,28.037071 L 30.667507,28.316343 L 28.555212,28.822307 L 26.592174,29.636994 L 23.449009,31.926988 L 21.288761,35.366403 L 20.04288,40.120079 L 19.64282,46.352853 L 19.76469,49.921069 L 20.129967,53.051903 L 20.738157,55.742421 L 21.588763,57.989689 L 22.493659,59.483844 L 23.693331,60.897973 L 25.063477,62.105231 L 26.479794,62.978775 L 28.679192,63.850643 L 31.123573,64.403828 L 34.222844,64.701226 L 38.386908,64.805734 L 39.479896,64.812328 L 40.572885,64.818921 L 41.665874,64.825514 L 42.758862,64.832108 L 42.758862,60.203045 L 42.758862,55.573981 L 42.758862,50.944918 Z M 42.758862,81.616269 L 42.758862,80.636335 L 42.758862,79.6564 L 42.758862,78.676465 L 42.758862,77.696531 L 41.735985,77.696531 L 40.713109,77.696531 L 39.690232,77.696531 L 38.667356,77.696531 L 33.674732,77.582832 L 29.429291,77.226367 L 25.744187,76.604084 L 22.432572,75.692928 L 18.854925,74.260309 L 15.813446,72.505662 L 13.211766,70.36239 L 10.953519,67.763895 L 8.2777092,62.963157 L 6.4559586,57.00908 L 5.5355698,50.123147 L 5.5638456,42.526843 L 6.0590608,37.647127 L 6.8889484,33.484965 L 8.1209217,29.783221 L 9.8223941,26.284754 L 11.087912,24.497274 L 12.881428,22.525318 L 14.871875,20.701035 L 16.728185,19.356575 L 19.300134,18.043101 L 22.204726,16.948859 L 25.430659,16.077498 L 28.966633,15.432662 L 30.828875,15.245912 L 34.037481,15.140114 L 39.917546,15.09298 L 49.794166,15.082221 L 58.657932,15.095274 L 64.676685,15.138975 L 68.379908,15.220137 L 70.29708,15.345573 L 75.663466,16.307693 L 80.193746,17.7734 L 84.000702,19.789778 L 87.197114,22.403911 L 89.980669,25.878064 L 92.103846,30.090268 L 93.583219,35.082855 L 94.43536,40.898157 L 94.575209,44.008582 L 94.559899,47.757248 L 94.405586,51.437004 L 94.128425,54.340702 L 91.617576,63.462255 L 87.014064,70.220069 L 80.173254,74.756912 L 70.950508,77.215552 L 69.651918,77.346401 L 67.774843,77.466453 L 65.5006,77.566121 L 63.01051,77.635816 L 61.565757,77.66513 L 60.121004,77.694444 L 58.676252,77.723758 L 57.231499,77.753072 L 57.231499,78.725939 L 57.231499,79.698807 L 57.231499,80.671674 L 57.231499,81.644541 L 57.231499,82.617408 L 57.231499,83.590274 L 57.231499,84.563141 L 57.231499,85.536008 L 55.422417,85.536008 L 53.613335,85.536008 L 51.804253,85.536008 L 49.995171,85.536008 L 48.186094,85.536008 L 46.377016,85.536008 L 44.567939,85.536008 L 42.758862,85.536008 L 42.758862,84.556073 L 42.758862,83.576138 L 42.758862,82.596204 Z"    
    "M 58.222295,74.441803 L 60.616674,74.082222 L 62.963236,73.545706 L 65.081319,72.880895 L 66.79026,72.136427 L 68.491924,70.973658 L 70.213167,69.361102 L 71.739221,67.52673 L 72.855321,65.698516 L 73.978965,62.72989 L 74.782379,59.175733 L 75.264909,55.039921 L 75.425898,50.326332 L 74.900338,42.121966 L 73.264134,35.860834 L 70.427998,31.327419 L 66.302642,28.306203 L 63.123408,27.045203 L 59.486935,26.288716 L 54.749717,25.952785 L 48.268248,25.953455 L 42.986187,26.129439 L 39.29208,26.496189 L 36.491344,27.164408 L 33.889396,28.244796 L 29.506084,31.498575 L 26.595616,36.452148 L 25.05613,43.377469 L 24.785765,52.546491 L 25.173727,57.986741 L 25.98775,62.354617 L 27.279512,65.842938 L 29.10069,68.644525 L 30.074876,69.665891 L 31.275662,70.703144 L 32.561074,71.643402 L 33.78914,72.373781 L 35.325714,72.993951 L 37.380457,73.610715 L 39.585734,74.126392 L 41.573909,74.443306 L 45.082133,74.631779 L 49.927718,74.694258 L 54.758495,74.630886 Z M 41.96889,91.55342 L 30.508845,89.725017 L 21.405536,85.987733 L 14.519198,80.258809 L 9.7100625,72.455489 L 7.0609187,63.246184 L 5.9541919,52.366084 L 6.4292517,41.189452 L 8.5254675,31.090549 L 12.502098,22.652235 L 18.430245,16.339101 L 26.496534,12.009195 L 36.887588,9.5205676 L 41.237197,9.1734547 L 47.350448,8.9734843 L 53.701028,8.9482412 L 58.762624,9.12531 L 67.122434,10.214164 L 74.104382,12.184073 L 79.874371,15.098594 L 84.598303,19.021285 L 86.832928,21.604969 L 88.656845,24.302215 L 90.174634,27.29097 L 91.490873,30.749179 L 92.688137,34.979907 L 93.495429,39.432471 L 93.952073,44.399956 L 94.097392,50.175447 L 93.951981,55.724373 L 93.499006,60.663306 L 92.721145,65.124584 L 91.601078,69.240545 L 87.123747,78.307821 L 80.304176,84.974839 L 71.013667,89.329619 L 59.123518,91.460182 L 55.557437,91.607883 L 50.504022,91.678151 L 45.471698,91.662744 Z"
    "M 7.4956804,50.304684 L 7.4956804,39.314341 L 7.4956804,28.323997 L 7.4956804,17.333654 L 7.4956804,6.3433103 L 10.034699,6.3433103 L 12.573717,6.3433103 L 15.112735,6.3433103 L 17.651753,6.3433103 L 20.190779,6.3433103 L 22.729804,6.3433103 L 25.26883,6.3433103 L 27.807856,6.3433103 L 27.807856,10.478298 L 27.807856,14.613287 L 27.807856,18.748275 L 27.807856,22.883263 L 27.807856,27.018251 L 27.807856,31.153239 L 27.807856,35.288227 L 27.807856,39.423215 L 33.32116,39.423215 L 38.834463,39.423215 L 44.347767,39.423215 L 49.861071,39.423215 L 55.374375,39.423215 L 60.887678,39.423215 L 66.400981,39.423215 L 71.914285,39.423215 L 71.914285,35.288227 L 71.914285,31.153239 L 71.914285,27.018251 L 71.914285,22.883263 L 71.914285,18.748275 L 71.914285,14.613287 L 71.914285,10.478298 L 71.914285,6.3433103 L 74.489815,6.3433103 L 77.065344,6.3433103 L 79.640873,6.3433103 L 82.216403,6.3433103 L 84.791932,6.3433103 L 87.367461,6.3433103 L 89.94299,6.3433103 L 92.518519,6.3433103 L 92.500147,17.315508 L 92.481775,28.287706 L 92.463404,39.259903 L 92.445032,50.232101 L 92.426667,61.204298 L 92.408301,72.176496 L 92.389936,83.148693 L 92.371571,94.12089 L 89.814414,94.139926 L 87.257257,94.158962 L 84.700099,94.177999 L 82.142942,94.197035 L 79.585778,94.216139 L 77.028614,94.235243 L 74.471449,94.254348 L 71.914285,94.273452 L 71.914285,89.811086 L 71.914285,85.34872 L 71.914285,80.886354 L 71.914285,76.423988 L 71.914285,71.961622 L 71.914285,67.499256 L 71.914285,63.036889 L 71.914285,58.574523 L 66.400981,58.574523 L 60.887678,58.574523 L 55.374375,58.574523 L 49.861071,58.574523 L 44.347767,58.574523 L 38.834463,58.574523 L 33.32116,58.574523 L 27.807856,58.574523 L 27.807856,63.03593 L 27.807856,67.497337 L 27.807856,71.958745 L 27.807856,76.420152 L 27.807856,80.881628 L 27.807856,85.343105 L 27.807856,89.804581 L 27.807856,94.266057 L 25.26883,94.266057 L 22.729804,94.266057 L 20.190779,94.266057 L 17.651753,94.266057 L 15.112735,94.266057 L 12.573717,94.266057 L 10.034699,94.266057 L 7.4956804,94.266057 L 7.4956804,83.275714 L 7.4956804,72.28537 L 7.4956804,61.295027 Z"
    "M 49.258798,97.949571 L 47.900168,97.863676 L 47.232388,97.824581 L 47.144488,97.821691 L 47.056588,97.818801 L 47.064718,87.634354 L 47.072848,77.449907 L 47.080978,67.265464 L 47.089108,57.081022 L 47.164438,57.016891 L 47.239768,56.952761 L 47.861158,56.842589 L 50.879738,56.824506 L 54.310678,56.775409 L 55.446988,56.447602 L 56.497498,55.539214 L 57.157018,54.230507 L 57.228218,53.967575 L 57.299418,53.704643 L 57.307718,40.814249 L 57.316018,27.923855 L 57.345278,7.3617526 L 57.411748,2.1432027 L 57.786288,2.192552 L 58.575708,2.3110077 L 65.072508,3.8605364 L 71.220758,6.4020639 L 78.087788,10.67961 L 84.197798,16.275549 L 88.405528,21.442839 L 91.851718,27.283886 L 95.403498,36.388515 L 97.100298,46.19014 L 97.181108,49.796101 L 97.100268,53.402723 L 96.427368,58.731373 L 95.242368,63.802975 L 92.060768,71.937778 L 87.494018,79.435104 L 80.178598,87.288897 L 71.428478,93.188261 L 64.890518,95.894103 L 58.057798,97.547331 L 54.339688,97.87043 L 51.113728,98.077991 L 50.567068,98.036473 Z M 58.277118,74.538754 L 60.440578,73.184525 L 61.648628,70.868512 L 61.754948,69.543979 L 61.617108,68.216817 L 60.679088,66.257463 L 59.082988,64.96197 L 58.191798,64.628539 L 57.203698,64.494229 L 54.522388,65.057382 L 52.582758,67.01305 L 51.924148,69.390558 L 52.400598,71.819968 L 53.619648,73.445585 L 55.312258,74.468592 L 56.798338,74.709978 Z M 70.885378,74.668986 L 71.326298,74.574195 L 71.768228,74.440232 L 73.790678,72.926659 L 74.915728,70.447075 L 74.537698,67.471639 L 72.626038,65.156158 L 70.105018,64.476046 L 67.552188,65.155998 L 67.118408,65.500519 L 66.583178,66.01619 L 66.053388,66.625506 L 65.737878,67.156945 L 65.364418,68.224148 L 65.277078,69.605873 L 65.303938,70.607949 L 65.461428,71.273479 L 65.941198,72.328834 L 66.692398,73.286444 L 68.602278,74.501755 Z M 84.706678,74.536145 L 86.717078,73.310989 L 87.994348,71.272114 L 88.031958,68.087023 L 86.278548,65.455413 L 84.038198,64.527639 L 81.561288,64.787129 L 79.190558,66.797066 L 78.411268,69.941742 L 79.373468,72.641489 L 81.552678,74.400833 L 83.114448,74.71184 Z M 40.611948,97.435721 L 40.105618,97.328387 L 39.112308,97.111531 L 28.745188,93.402745 L 19.457468,87.18667 L 15.296188,83.088253 L 11.515348,78.420802 L 8.1365775,72.937747 L 5.5830175,67.060916 L 3.2895275,58.540456 L 2.5790175,49.872194 L 3.2549275,41.378475 L 5.4623375,33.073303 L 8.4942975,26.105129 L 12.459558,19.990016 L 19.166078,12.743004 L 27.012778,7.2113079 L 32.654498,4.556237 L 38.601788,2.7898479 L 40.800928,2.3940419 L 44.496908,2.0092021 L 48.187858,1.7065342 L 50.582948,1.7176867 L 51.085488,1.7396007 L 51.588028,1.7615147 L 51.587558,14.042813 L 51.587088,26.324111 L 51.570218,46.011723 L 51.505488,51.054437 L 51.465148,51.138305 L 51.424818,51.222172 L 49.622988,51.239944 L 47.821148,51.257716 L 44.643918,51.308626 L 43.791568,51.443339 L 42.988218,51.867739 L 42.321238,52.506092 L 41.862398,53.232929 L 41.570098,54.101161 L 41.457988,57.305306 L 41.441538,76.057606 L 41.441538,86.770473 L 41.441538,97.483341 L 41.274018,97.478766 L 41.106508,97.474191 L 40.823028,97.459126 Z M 42.157508,42.873805 L 43.579408,42.221369 L 44.857358,41.107626 L 46.110218,38.690712 L 46.097278,35.918529 L 44.597848,33.206672 L 42.153908,31.694323 L 40.828338,31.600655 L 39.495198,31.698902 L 38.554278,32.053914 L 37.644578,32.621263 L 36.634468,33.683608 L 35.862748,34.961184 L 35.528728,35.943562 L 35.399488,37.067168 L 35.455768,38.358837 L 35.784098,39.51464 L 37.343678,41.690739 L 39.617928,42.900173 L 40.903138,42.998301 Z"
]   

canvas = null
tt = null

onShapeClick = (e)->
    changeTT(this)
    
changeTT = (e)->
    e.unmousedown()
    if tt
        subject = tt.subject 
        tt.unplug()
        subject.mousedown onShapeClick
    tt = canvas.freeTransform e, 
        keepRatio: false
        scale: true
        draw: 'bbox' 
    tt.updateHandles()

onButtonClick = (e)=>
    p = e.data.value
    shape = createShape(p)
        .translate(206,206)
    changeTT shape

createShape = (p)=>
    canvas
        .path(p)
        .attr("stroke","#777")
        .attr("stroke-width",4)
        .attr("fill","#FFF")
        .attr("fill-opacity",0.3)
        # .attr("style", "vector-effect: non-scaling-stroke;")

generateButtons = ()=>
    btns = $("#buttons")
    id = 0
    w = 32
    for p in shapes
        bid = "svgbtn#{id}"
        btn = $ "<button id=\"#{bid}\" width=\"16px\" height=\"16px\" class=\"btn btn-default\" style=\"margin:0px; margin-right:4px; padding:4px;padding-bottom:0px;\"></button>"
        btns.append btn
        btn.on "click", value: p, onButtonClick
        paper = Raphael bid, 16, 16
        paper.setViewBox(0,0,100,100)
        shape = paper.path(p)
            .attr("fill","#666")
            .attr("stroke", "none")
        id++

send = ->

    shapes = null
    
    tt.unplug()
    for p in $("#raphael svg path")
        m = p.getCTM()
        m = Raphael.matrix(m.a, m.b, m.c, m.d, m.e, m.f)
        d = p.getAttribute("d")
        # console.log d, m
        d = Raphael.mapPath(d, m)
        p.remove()
        # console.log shapes
        if !shapes?
            shapes = d
        else
            shapes = shapes.concat d
    
    # tt.showHandles()

    gcode = generateGCode shapes
    shapes = generateSVG shapes
    
    #group = createShape(shapes)
    #changeTT group 

    $.ajax
        url: "/post"
        method: "POST"
        # contentType: "application/json"
        data:
            gcode: gcode
            shapes: shapes


generateSVG = (shapes)=>
    SVG = []
    pr = 4
    for e in shapes 
        c = e[0]
        switch c
            when "M"
                SVG.push "Z" if SVG.length
                SVG.push "M #{e[1].toFixed(pr)},#{e[2].toFixed(pr)}"
            when "L"
                SVG.push "L #{e[1].toFixed(pr)},#{e[2].toFixed(pr)}"
            when "C"
                SVG.push "L #{e[5].toFixed(pr)},#{e[6].toFixed(pr)}"
    SVG.join " "

generateGCode = (shapes)=>
    G = ["G28"]
    UP = 60
    DN = 56
    dx = -256
    dy = -256
    sx = 0.3
    sy =-0.3
    pr = 4
    lt = null
    for e in shapes 
        c = e[0]
        console.log c
        switch c
            when "M"
                G.push "G1 X#{lt.x} Y#{lt.y} Z#{UP}" if lt # up at last point if there is one
                G.push "G1 X#{((e[1]+dx)*sx).toFixed(pr)} Y#{((e[2]+dy)*sy).toFixed(pr)} Z#{UP}"
                G.push "G1 Z#{DN}"
            when "L"
                lt = x: (e[1]+dx)*sx, y:(e[2]+dy)*sy
                G.push "G1 X#{lt.x.toFixed(pr)} Y#{lt.y.toFixed(pr)}"
            when "C"
                lt = x: (e[5]+dx)*sx, y:(e[6]+dy)*sy
                G.push "G1 X#{lt.x.toFixed(pr)} Y#{lt.y.toFixed(pr)}"

    G.push "G28"
    G.join "\n"
            

setupPlayer = ()=>

    jwplayer("video1").setup
        sources  : [
            file: "rtmp://vs43.ailove.ru/webcam/video0"]
        image    : "/bg.jpg"
        autostart: true
        width    : 320
        height   : 240
        primary  : "flash"

    jwplayer("video2").setup
        sources  : [
            file: "rtmp://vs43.ailove.ru/webcam/video1"]
        image    : "/bg.jpg"
        autostart: true
        width    : 320
        height   : 240
        primary  : "flash"


refreshTasksList = ()->

    $.get "/tasks", (tasks)->
        id = 0
        $("#queue").empty()
        for t in tasks.tasks
            json = JSON.parse t 
            tid = "task_#{id++}"
            $("#queue").prepend("<span id=\"#{tid}\" class=\"img-thumbnail\" style=\"width:46%;margin:2px;\"/>")
            paper = Raphael tid, "100%", "100%"
            paper.setViewBox(0,0,512,512,true)
            console.log t.shapes
            shape = paper.path(json.shapes)
                .attr("stroke", "#666")
                .attr("stroke-width", "4")
                .attr("fill","#none")


$ ->
    
    generateButtons()
    setupPlayer()

    paper = null
    W = H = W2 = H2 = 0

    resize = ()=>
        W = 512
        H = 512
        W2= W>>1
        H2= H>>1
        paper.setSize W, H if paper
        # paper.setSize("100%", "100%") if paper
  
    $(window).resize resize
    resize()

    canvas = Raphael("raphael", "100%", "100%")
    canvas.setViewBox(0,0,512,512,true)
    $("#remove").click -> tt.subject.remove(); tt.unplug()
    $("#trash").click ->
        canvas.clear()

    $("#send").click send
    
    # ws = io.connect()
    # ws.emit 'ready' 
    # ws.on 'talk', (data)->alert(data.message)
    
    #setInterval refreshTasksList, 2000
    refreshTasksList()


    # rect = paper.rect(W2, H2, 50, 50).attr('fill', '#FFFFFF').attr('fill-opacity',0.5)
    # # Add freeTransform
    # ft = paper.freeTransform(rect)
    # # Hide freeTransform handles
    # ft.hideHandles()
    # # Show hidden freeTransform handles
    # ft.showHandles()
    # # Apply transformations programmatically
    # ft.attrs.rotate = 45
    # ft.apply()
    # # Remove freeTransform completely
    # ft.unplug()
    # # Add freeTransform with options and callback
    # ft = paper.freeTransform(rect, { keepRatio: true }, (ft, events) ->
    #   console.log ft.attrs
    #   return
    # )
    # # Change options on the fly
    # ft.setOpts keepRatio: false
